@startuml

' Visualizar en VS Code con la extension PlantUML (Alt + D)
skinparam classAttributeIconSize 0
hide circle
hide empty members

enum TipoRol {
  ADMINISTRADOR
  TECNICO
  RECEPCION
  CLIENTE
}

enum EstadoOrden {
  RECIBIDO
  EN_DIAGNOSTICO
  EN_REPARACION
  LISTO
  ENTREGADO
}

class Rol {
  +id: int
  +nombre: TipoRol
  +descripcion: string
}

class Usuario {
  +id: int
  +nombre: string
  +apellido: string
  +email: string
  +telefono: string
  +passwordHash: string
  +activo: bool
  +iniciarSesion()
}

class Cliente {
  +id: int
  +nombre: string
  +apellido: string
  +documento: string
  +telefono: string
  +email: string
  +direccion: string
  +ciudad: string
  +actualizarPerfil()
}

class Tecnico {
  +id: int
  +nombre: string
  +apellido: string
  +email: string
  +especialidad: string
  +activo: bool
}

class GrupoResponsable {
  +id: int
  +nombre: string
  +descripcion: string
  +activo: bool
}

class ReglaAsignacion {
  +id: int
  +palabrasClave: string
  +prioridad: int
  +activo: bool
  +evaluar(texto): bool
}

class TipoEquipo {
  +id: int
  +nombre: string
}

class Equipo {
  +id: int
  +marca: string
  +modelo: string
  +serie: string
  +color: string
  +accesorios: string
}

class OrdenServicio {
  +id: int
  +codigo: string
  +fallaReportada: string
  +diagnostico: string
  +observaciones: string
  +fechaRecepcion: datetime
  +fechaEntregaEstimada: datetime
  +fechaEntregaReal: datetime
  +costoEstimado: decimal
  +costoFinal: decimal
  +saldo: decimal
  +pagado: bool
  +estado: EstadoOrden
  +asignarTecnico()
  +cambiarEstado()
  +registrarPago()
}

class HistorialEstado {
  +id: int
  +estado: EstadoOrden
  +comentario: string
  +fecha: datetime
}

class Pago {
  +id: int
  +metodo: string
  +valor: decimal
  +referencia: string
  +fecha: datetime
}

class Factura {
  +numero: string
  +fechaEmision: datetime
  +total: decimal
  +saldo: decimal
  +generarPDF()
}

Rol "1" -- "0..*" Usuario : asigna >
Cliente "1" -- "0..1" Usuario : perfilLogin >

Cliente "1" -- "0..*" Equipo : posee >
TipoEquipo "1" -- "0..*" Equipo : clasifica >

Cliente "1" -- "0..*" OrdenServicio : solicita >
Equipo "1" -- "0..*" OrdenServicio : correspondeA >
Tecnico "0..1" -- "0..*" OrdenServicio : asignado >
GrupoResponsable "0..1" -- "0..*" OrdenServicio : responsable >

OrdenServicio "1" o-- "0..*" HistorialEstado : registra >
Usuario "0..1" -- "0..*" HistorialEstado : actualizadoPor >

OrdenServicio "1" o-- "0..*" Pago : recibe >
Cliente "1" -- "0..*" Pago : realiza >
Usuario "0..1" -- "0..*" Pago : registradoPor >

OrdenServicio "1" -- "0..1" Factura : genera >

Tecnico "1" -- "0..*" GrupoResponsable : perteneceA >
GrupoResponsable "1" -- "0..*" ReglaAsignacion : define >
Tecnico "0..1" -- "0..*" ReglaAsignacion : sugiere >

@enduml
